# Страницы в ZedCMS #

Страницей ZedCMS является файл размещенный в папке или подпапке **/public/root/**. Чтобы понять, как страницы вызываются смотрите [Принцип работы](PrinciplesOfWork.md).
Все взаимодействие клиента с фреймворком сводится к выводу какой либо страницы.

Тут будут описаны внутренние процессы страницы.

# Функция страниц #
Страницы встраиваются в [общий шаблон сайта](MainTemplates.md), в заранее определенное место. В случае если шаблон не определен в [конфигурации сайта](SiteConfiguration.md) или если он был отключен явно во время вывода страницы, последняя будет выведена без шаблона:
```
define(Z_SUPPRESS_TEMPLATE, true);
```

Отключить шаблон можно в любом месте выполнения программы PHP, однако лучше это делать в самом начале вывода страницы, для прозрачности кода.

# Доступность страниц #
Страница доступна по одному или многим URL. Это достигается за счет [Urlrewrite](UrlRewrite.md).

По умолчанию страница доступна по URL, который соответствует положению страницы относительно папки **/public/root/** и ее названию.
Примеры:
  * **www.site1.com** (ведет на страницу **/public/root/index.php**)
  * **www.site1.com/contacts.php** (ведет на страницу **/public/root/contacts.php**)
  * **www.site1.com/contacts/** (ведет на страницу **/public/root/contacts/index.php**)
  * **www.site1.com/contacts/address2.php** (ведет на страницу **/public/root/contacts/address2.php**)

По этому для создания страниц на сайте достаточно создать соответствующий файл и он сразу же будет доступен веб клиенту в виде страницы.

# Содержание страниц #
Страницы могут быть простым HTML кодом, текстом, PHP скриптом, или всем этим одновременно. Как описывалось в [концепте фреймворка](FrameworkConcept.md) страницы должны разбиваться на блоки (паттерн БЭМ), которые в свою очередь реализуются с помощью [компонентов](Components.md). Например, в случае страницы контактов, можно сделать следующие компоненты:
  * телефоны компании (код компонента mysite:contacts.phones)
  * карта с местоположением (код компонента mysite:map)

Остальную информацию, можно внести обычным текстом или HTML кодом. Среди которой вызвать размещение компонентов. Пример:
```
<div class="b-contacts">
Вы можете обратиться к нам по телефонам, или приехать в офис.
Наши телефоны:
<?Z_Component::placeComponent("mysite:contacts.phones", "contacts_page", array());?>

Наш офис находится по адресу: г.Москва, Минский переулок, 1.
<?Z_Component::placeComponent("mysite:map", "", array(
   "center" => "35.86,58.01"
   "z" => 10,
   "point" => "35.90,58.10"
   "point_label" => "Наш адрес"
));?>
</div>
```

Как видно из примера, компонент телефонов вызывается без параметров, а компонент карты, получает параметры центра карты, масштаба положение отметки и ее надпись.

В итоге клиент получит страницу обернутую в шаблон сайта. Как вы уже заметили страница не отвечает за отрисовку тегов 

&lt;html&gt;

 

&lt;body&gt;

 

&lt;head&gt;

, эти задачи ложаться на [шаблон сайта](MainTemplates.md).

Такая организация страницы позволяет очень быстро и гибко изменять ее вид и содержание и позволяет легко разобраться разработчикам, что страница делает.

# Изменение параметров шаблона изнутри страницы #
Помимо самого вывода страницы, существует потребность изменить "что-то" в шаблоне. Например:
  * подключить дополнительный CSS файл
  * подключить дополнительный JS файл
  * изменить заголовок страницы
  * изменить meta теги (ключевые слова или описание страницы)
  * другие нестандартные изменения

Для этого предусмотрены специальные статические методы и переменные [библиотеки](Libraries.md) Z\_Application:
  * **Z\_Application::addHeadString($string)** - добавляет любую строку в head HTML документа, например для подключения CSS или JS
  * **Z\_Application::$seoComponents["title"]** - заголовок страницы
  * **Z\_Application::$seoComponents["keywords"]** - ключевые слова страницы
  * **Z\_Application::$seoComponents["robots"]** - мета тег robots (index, follow или noindex, nofollow)
  * **Z\_Application::$seoComponents["description"]** - скрытое описание страницы
  * **Z\_Application::$globals** - глобальный массив, который доступен из любого места, в том числе из шаблона сайта, таким образом, через него можно передать любую информацию "сквозь" все сущности фреймворка.

Для работоспособности указанных методов изменения шаблона изнутри страницы, необходимо подготовить и сам шаблон, установить в нем метки вывода. Подробнее в [шаблонах](MainTemplates.md).

Пример страницы контактов с изменениями в шаблоне сайта:
```
<?
   // Подключаем дополнительные стили
   Z_Application::addHeadString("<link href=\"/css/contacts.css\" type=\"text/css\" rel=\"stylesheet\" /> ");

   Z_Application::$seoComponents["title"] = "Контакты ООО \"Рога и копыта\"";
   Z_Application::$seoComponents["keywords"] = "Контакты, ООО Рога и копыта, телефоны, адрес, точка на карте";
   Z_Application::$seoComponents["robots"] = "index, follow";
   Z_Application::$seoComponents["description"] = "Контакты компании ООО \"Рога и копыта\", телефоны, адрес, расположение на карте"
?>
<div class="b-contacts">
Вы можете обратиться к нам по телефонам, или приехать в офис.
Наши телефоны:
<?Z_Component::placeComponent("mysite:contacts.phones", "contacts_page", array());?>

Наш офис находится по адресу: г.Москва, Минский переулок, 1.
<?Z_Component::placeComponent("mysite:map", "", array(
   "center" => "35.86,58.01"
   "z" => 10,
   "point" => "35.90,58.10"
   "point_label" => "Наш адрес"
));?>
</div>
```

Надо отметить, что манипуляция над шаблоном, может быть не только в самой странице, но и в компонентах, например, при вызове компонента с картой, необходимо подключить нужные JS и CSS файлы, что разумно сделать в обработчике самого компонента. Однако, внутри компонента необходимо следить, чтобы стили и javascript не подключались по нескольку раз, в случае размещения нескольких карт на одной странице. Это можно легко сделать c помощью глобальной переменной:
```
if(!Z_Application::$globals["mysite.map.css.js.loaded"]) {
   // ... Тут подключаем все нужные файлы или стили с помощью Z_Application::addHeadString
   Z_Application::$globals["mysite.map.css.js.loaded"] = true;
}

```